{"version":3,"file":"scenario-engine.js","sourceRoot":"","sources":["../../server/engine/scenario-engine.ts"],"names":[],"mappings":"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"}